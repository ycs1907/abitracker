<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arena Breakout Infinite Sezon 4 TÃ¼rkÃ§e GÃ¶rev Rehberi</title>
    
    <meta name="google-site-verification" content="srPe7K2_PkHflgIWQRSSP2DuqMIsI4yHvhLpnWVVXKM" />

    <meta name="description" content="Sezon 4 gÃ¶revlerinde mi takÄ±ldÄ±n? Hemen buraya tÄ±kla, en detaylÄ± TÃ¼rkÃ§e rehber ve taktikler ile gÃ¶revlerini saniyeler iÃ§inde bitirerek hÄ±zla ilerlemeye baÅŸla!">
    <meta name="keywords" content="arena breakout infinite, sezon 4 gÃ¶revleri, tÃ¼rkÃ§e rehber, arena breakout taktikleri, abi s4 rehber, arena breakout gÃ¶rev nasÄ±l yapÄ±lÄ±r, abi tÃ¼rkÃ§e gÃ¶revler">
    <meta name="robots" content="index, follow">
    <meta name="language" content="Turkish">
    <link rel="canonical" href="https://abitracker.vercel.app/">

    <meta property="og:url" content="https://abitracker.vercel.app/">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Arena Breakout Infinite Sezon 4 TÃ¼rkÃ§e GÃ¶rev Rehberi">
    <meta property="og:description" content="Sezon 4 gÃ¶revlerinde mi takÄ±ldÄ±n? Hemen buraya tÄ±kla, en detaylÄ± TÃ¼rkÃ§e rehber ve taktikler ile gÃ¶revlerini saniyeler iÃ§inde bitirerek hÄ±zla ilerlemeye baÅŸla!">
    <meta property="og:image" content="https://abitracker.vercel.app/og-image.jpg">

    <meta name="twitter:card" content="summary_large_image">
    <meta property="twitter:domain" content="abitracker.vercel.app">
    <meta property="twitter:url" content="https://abitracker.vercel.app/">
    <meta name="twitter:title" content="Arena Breakout Infinite Sezon 4 TÃ¼rkÃ§e GÃ¶rev Rehberi">
    <meta name="twitter:description" content="Sezon 4 gÃ¶revlerinde mi takÄ±ldÄ±n? Hemen buraya tÄ±kla, en detaylÄ± TÃ¼rkÃ§e rehber ve taktikler ile gÃ¶revlerini saniyeler iÃ§inde bitirerek hÄ±zla ilerlemeye baÅŸla!">
    <meta name="twitter:image" content="https://abitracker.vercel.app/og-image.jpg">

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #f5a623; --bg: #0a0b0c; --card-bg: #141618; --text: #e0e0e0; --accent: #2ecc71; --border: #2c2f33; --highlight: #ff4d4d; --tier-6: #ff4d4d; --tier-5: #9b59b6; --tier-4: #3498db; --tier-3: #f1c40f; }
        html { overflow-y: scroll; scroll-behavior: smooth; }
        body { font-family: 'Inter', sans-serif; background-color: var(--bg); color: var(--text); margin: 0; padding: 15px; line-height: 1.5; user-select: none; -webkit-user-select: none; }
        .container { max-width: 750px; margin: 0 auto; }
        .main-nav { display: flex; gap: 8px; margin-bottom: 20px; justify-content: flex-start; }
        .nav-btn { background: var(--card-bg); border: 1px solid var(--border); color: #888; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-weight: 800; font-size: 0.75rem; text-transform: uppercase; letter-spacing: 1px; transition: all 0.2s; }
        .nav-btn.active { background: var(--primary); color: #000; border-color: var(--primary); }
        .search-row { display: flex; gap: 10px; margin-bottom: 15px; align-items: center; }
        #taskSearch { flex: 1; background: #000; border: 1px solid var(--border); border-radius: 6px; padding: 12px 15px; color: var(--primary); font-family: 'Inter', sans-serif; font-size: 0.85rem; outline: none; transition: border-color 0.3s; }
        #taskSearch:focus { border-color: var(--primary); }
        .toggle-box { display: flex; align-items: center; gap: 8px; font-size: 0.65rem; color: #666; font-weight: 800; white-space: nowrap; cursor: pointer; }
        #hideDone { width: 16px; height: 16px; cursor: pointer; accent-color: var(--primary); }
        .ai-suggestion { background: rgba(245, 166, 35, 0.07); border: 1px solid var(--border); border-left: 4px solid var(--primary); border-radius: 8px; padding: 15px; margin-bottom: 20px; display: flex; align-items: flex-start; gap: 12px; font-size: 0.85rem; animation: fadeIn 0.5s ease; }
        .ai-icon { font-size: 1.4rem; filter: drop-shadow(0 0 5px var(--primary)); }
        .ai-text { color: #bbb; line-height: 1.4; }
        .ai-text strong { color: var(--primary); text-transform: uppercase; letter-spacing: 1px; }
        .ai-next-tasks { display: block; margin-top: 5px; font-size: 0.75rem; color: #666; font-style: italic; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }
        .progress-bg { width: 100%; height: 18px; background: #222; border-radius: 9px; overflow: hidden; position: relative; border: 1px solid #1a1a1a; }
        .progress-fill { height: 100%; background: var(--primary); width: 0%; transition: width 0.4s ease; }
        .progress-percent { position: absolute; width: 100%; text-align: center; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 0.65rem; font-weight: 800; color: #fff; text-shadow: 1px 1px 2px rgba(0,0,0,0.8); pointer-events: none; }
        #ballistics-panel { display: none; background: var(--card-bg); border: 1px solid var(--border); border-radius: 10px; padding: 15px; animation: fadeIn 0.5s ease; }
        .intel-note { background: rgba(245, 166, 35, 0.04); border: 1px dashed var(--primary); padding: 12px; border-radius: 6px; font-size: 0.75rem; margin-bottom: 15px; color: var(--primary); line-height: 1.4; }
        .ammo-table { width: 100%; border-collapse: collapse; font-size: 0.8rem; text-align: left; }
        .ammo-table th { padding: 12px 8px; border-bottom: 2px solid var(--border); color: var(--primary); font-size: 0.7rem; text-transform: uppercase; }
        .ammo-table td { padding: 10px 8px; border-bottom: 1px solid rgba(255,255,255,0.03); }
        .ammo-group { background: rgba(255,255,255,0.02); font-weight: 800; color: #555; font-size: 0.65rem; padding: 5px 10px !important; }
        .t-badge { display: inline-block; padding: 2px 8px; border-radius: 4px; font-weight: 800; font-size: 0.7rem; color: #fff; min-width: 25px; text-align: center; }
        .t6 { background: var(--tier-6); box-shadow: 0 0 8px rgba(255, 77, 77, 0.3); }
        .t5 { background: var(--tier-5); }
        .t4 { background: var(--tier-4); }
        .t3 { background: var(--tier-3); color: #000; }
        .t2 { background: #7f8c8d; }
        #scrollTopBtn { display: none; position: fixed; bottom: 30px; right: 30px; z-index: 1001; background: var(--primary); color: #000; border: none; width: 45px; height: 45px; border-radius: 50%; cursor: pointer; font-size: 20px; font-weight: bold; box-shadow: 0 4px 15px rgba(0,0,0,0.5); }
        #map-panel { display: none; margin-top: 10px; }
        .map-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .map-link { background: var(--card-bg); border: 1px solid var(--border); border-radius: 8px; padding: 25px 15px; text-decoration: none; text-align: center; transition: 0.2s; display: flex; flex-direction: column; justify-content: center; }
        .map-link:hover { border-color: var(--primary); background: #1c1f22; transform: translateY(-2px); }
        .map-link .name { color: var(--primary); font-weight: 800; font-size: 0.95rem; display: block; }
        .map-link .src { color: #666; font-size: 0.65rem; margin-top: 5px; display: block; letter-spacing: 1px; }
        .map-info-text { text-align: center; margin-top: 20px; font-size: 0.75rem; color: #666; font-style: italic; border-top: 1px dashed var(--border); padding-top: 15px; }
        header { text-align: center; padding: 25px 15px; background: linear-gradient(180deg, #1a1c1e 0%, #0a0b0c 100%); border-radius: 12px; margin-bottom: 10px; border: 1px solid var(--border); }
        h1 { font-weight: 800; text-transform: uppercase; color: #fff; margin: 0; letter-spacing: 1px; font-size: 1.6rem; }
        .sub-header { color: var(--primary); font-weight: 600; font-size: 1rem; margin-top: 5px; }
        .sticky-bar { position: sticky; top: 10px; z-index: 1000; background: rgba(20, 22, 24, 0.98); padding: 15px; border-radius: 10px; box-shadow: 0 8px 25px rgba(0,0,0,0.5); margin-bottom: 20px; border: 1px solid var(--primary); }
        .progress-text { display: flex; justify-content: space-between; font-weight: 600; font-size: 0.85rem; margin-bottom: 8px; }
        .list-container { background: var(--card-bg); border-radius: 10px; border: 1px solid var(--border); overflow: hidden; }
        .task-row { display: flex; align-items: flex-start; padding: 12px 18px; border-bottom: 1px solid var(--border); transition: 0.2s; cursor: pointer; border-left: 5px solid transparent; }
        .task-row:hover { background: #1c1f22; }
        .task-row.hidden { display: none !important; }
        .task-row.is-done { border-left: 5px solid var(--accent); background: rgba(46, 204, 113, 0.03); }
        input[type="checkbox"] { width: 15px; height: 15px; margin-right: 15px; margin-top: 4px; accent-color: var(--accent); cursor: pointer; }
        .task-info { flex: 1; }
        .task-title { display: block; font-weight: 700; color: var(--primary); font-size: 0.85rem; margin-bottom: 3px; text-transform: uppercase; }
        .task-desc { display: block; font-size: 0.88rem; color: #b0b0b0; white-space: pre-wrap; }
        .hl { color: var(--highlight); font-weight: 600; }
        input[type="checkbox"]:checked + .task-info .task-title { text-decoration: line-through; color: var(--accent); opacity: 0.5; }
        input[type="checkbox"]:checked + .task-info .task-desc { opacity: 0.3; }
        
        /* HABERLER PANELÄ° STÄ°LLERÄ° */
        #news-panel { display: none; animation: fadeIn 0.5s ease; }
        #news-timer-container { width: 100%; height: 3px; background: #111; margin-bottom: 0; }
        #news-timer-bar { width: 0%; height: 100%; background: var(--primary); transition: width 0.1s linear; }
        .news-widget { display: flex; height: 300px; background: #000; border-radius: 0 0 8px 8px; overflow: hidden; border: 1px solid var(--border); border-top: none; }
        .news-img-box { flex: 1.6; background: #111; position: relative; }
        #news-preview-img { width: 100%; height: 100%; object-fit: cover; }
        
        /* HABERLER KAYDIRMA Ã‡UBUÄžU DÃœZENLEMESÄ° */
        .news-list-box { flex: 1; background: #0a0a0a; overflow-y: auto; border-left: 1px solid var(--border); scrollbar-width: thin; scrollbar-color: var(--primary) #0a0a0a; }
        .news-list-box::-webkit-scrollbar { width: 6px; }
        .news-list-box::-webkit-scrollbar-track { background: #0a0a0a; }
        .news-list-box::-webkit-scrollbar-thumb { background-color: var(--primary); border-radius: 10px; }

        .news-item { padding: 12px 15px; border-bottom: 1px solid #151515; cursor: pointer; border-left: 3px solid transparent; }
        .news-item:hover { background: #141414; border-left-color: var(--primary); }
        .news-item.active { background: #111; border-left-color: var(--primary); }
        .news-item h3 { margin: 0; font-size: 11px; color: #888; line-height: 1.4; }
        .news-item.active h3 { color: var(--primary); }
        .news-item span { font-size: 9px; color: #444; }
/* Detay kutusunun genel yapÄ±sÄ± */
#news-detail-box { 
    background: var(--card-bg); 
    border: 1px solid var(--border); 
    border-radius: 8px; 
    padding: 25px; 
    margin-top: 20px; 
    display: none; 
}

/* Kapatma butonuna fareyle gelince (Hover) rengi deÄŸiÅŸtirir */
#news-detail-box button:hover {
    color: var(--primary) !important; 
    transform: scale(1.1);
    transition: 0.2s; /* GeÃ§iÅŸin yumuÅŸak olmasÄ± iÃ§in bu ÅŸart */
}

        footer { text-align: center; padding: 50px 20px 40px; }
        .footer-wrapper { display: inline-block; border-top: 1px solid var(--border); padding-top: 20px; }
        .footer-content { display: inline-flex; align-items: center; gap: 12px; background: rgba(245, 166, 35, 0.05); padding: 10px 25px; border-radius: 4px; border: 1px solid var(--border); font-size: 0.75rem; letter-spacing: 1.5px; }
        .status-dot { width: 8px; height: 8px; background-color: var(--accent); border-radius: 50%; box-shadow: 0 0 10px var(--accent); animation: pulse 2s infinite; }
        @keyframes pulse { 0% { opacity: 0.3; transform: scale(0.9); } 50% { opacity: 1; transform: scale(1.1); } 100% { opacity: 0.3; transform: scale(0.9); } }
        .footer-main { color: #fff; font-weight: 800; }
        .separator { color: var(--primary); font-weight: 800; }
        .footer-sub { color: #888; }
        .footer-fine-print { margin-top: 12px; font-size: 0.65rem; color: #555; text-transform: uppercase; letter-spacing: 2px; }
        .signature { margin-top: 8px; font-size: 0.8rem; font-weight: 800; color: var(--primary); letter-spacing: 4px; opacity: 0.8; }
    </style>
</head>
<body>
<button onclick="scrollToTop()" id="scrollTopBtn">â†‘</button>
<div class="container">
    <header>
        <h1>ARENA BREAKOUT: INFINITE</h1>
        <div class="sub-header">Sezon 4 | 3x3 GÃ¼venli Kasa GÃ¶rev Takip Ã‡izelgesi</div>
    </header>
    <nav class="main-nav">
        <button class="nav-btn active" onclick="switchPanel('tasks')">GÃ–REVLER</button>
        <button class="nav-btn" onclick="switchPanel('news')">HABERLER</button>
        <button class="nav-btn" onclick="switchPanel('ballistics')">BALÄ°STÄ°K</button>
        <button class="nav-btn" onclick="switchPanel('maps')">HARÄ°TALAR</button>
    </nav>

    <div id="tasks-panel">
        <div id="route-suggestion" class="ai-suggestion" style="display:none;">
            <div class="ai-icon">ðŸŽ¯</div>
            <div class="ai-text"><span id="suggestion-content"></span><span id="next-task-list" class="ai-next-tasks"></span></div>
        </div>
        <div class="sticky-bar">
            <div class="progress-text"><span>OPERASYON Ä°LERLEMESÄ°</span><span id="stat-val">0 / 60</span></div>
            <div class="progress-bg">
                <div class="progress-fill" id="fill"></div>
                <div class="progress-percent" id="percent-val">0% TAMAMLANDI</div>
            </div>
        </div>
        <div class="search-row">
            <input type="text" id="taskSearch" placeholder="GÃ–REV VEYA HARÄ°TA ARA... (Esc: Temizle)" onkeyup="filterTasks(event)">
            <label class="toggle-box"><input type="checkbox" id="hideDone" onchange="filterTasks()"> BÄ°TENLERÄ° GÄ°ZLE</label>
        </div>
        <div class="list-container" id="task-list"></div>
    </div>

    <div id="news-panel">
        <div class="intel-note"><strong>HABER TERMÄ°NALÄ°:</strong> Global sunuculardan gelen anlÄ±k istihbarat akÄ±ÅŸÄ±.</div>
        <div id="news-timer-container"><div id="news-timer-bar"></div></div>
        <div class="news-widget" onmouseenter="newsPaused=true" onmouseleave="newsPaused=false">
            <div class="news-img-box"><img id="news-preview-img" src=""></div>
            <div class="news-list-box" id="news-list-container"></div>
        </div>
        <div class="map-info-text">* TÃ¼m haberler ve gÃ¶rseller arenabreakoutinfinite.com adresinden alÄ±nmÄ±ÅŸtÄ±r.</div>
        <div id="news-detail-box">
            <div style="display:flex; justify-content:space-between; align-items:flex-start; margin-bottom:15px; border-bottom:1px solid #222; padding-bottom:10px;">
                <div>
                    <h2 id="news-d-title" style="margin:0; font-size:18px; color:var(--primary);"></h2>
                    <span id="news-d-date" style="font-size:10px; color:#555;"></span>
                </div>
                <button onclick="document.getElementById('news-detail-box').style.display='none'" style="background:none; border:none; color:#555; cursor:pointer; font-size:20px;">âœ•</button>
            </div>
            <div id="news-d-body" style="font-size:14px; color:#999; line-height:1.7;"></div>
        </div>
    </div>

    <div id="ballistics-panel">
        <div class="intel-note"><strong>Ä°STÄ°HBARAT NOTU:</strong> Tier (T) deÄŸeri merminin zÄ±rh delme kapasitesini temsil eder. Seviye arttÄ±kÃ§a (T0-T6) merminin yÃ¼ksek seviyeli zÄ±rhlarÄ± delme olasÄ±lÄ±ÄŸÄ± artar.</div>
        <table class="ammo-table">
            <thead><tr><th>KALÄ°BRE</th><th>MÃœHÄ°MMAT TÄ°PÄ°</th><th>DELME</th></tr></thead>
            <tbody id="ammo-table-body"></tbody>
        </table>
    </div>

    <div id="map-panel">
        <div class="map-grid" id="map-list-container"></div>
        <div class="map-info-text">* Harita isimlerine tÄ±kladÄ±ÄŸÄ±nÄ±zda etkileÅŸimli sÃ¼rÃ¼m yeni bir sekmede aÃ§Ä±lacaktÄ±r.</div>
    </div>

    <footer>
        <div class="footer-wrapper">
            <div class="footer-content">
                <span class="status-dot"></span>
                <span class="footer-main">ABI S4 GÃ–REV TAKÄ°P SÄ°STEMÄ°</span>
                <span class="separator">//</span>
                <span class="footer-sub">OPERATÃ–R TERMÄ°NALÄ° v1.4.1</span>
            </div>
            <div class="footer-fine-print">VERÄ° AKIÅžI AKTÄ°F â€¢ <span id="current-date"></span></div>
            <div class="signature">YcS</div>
        </div>
    </footer>
</div>

<script src="tasks.js"></script>
<script src="ammo.js"></script>
<script src="maps.js"></script>

<script>
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    function playFeedback(type) {
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.connect(gain); gain.connect(audioCtx.destination);
        if (type === 'done') {
            osc.frequency.setValueAtTime(500, audioCtx.currentTime);
            osc.frequency.exponentialRampToValueAtTime(1000, audioCtx.currentTime + 0.1);
        } else {
            osc.frequency.setValueAtTime(300, audioCtx.currentTime);
            osc.frequency.exponentialRampToValueAtTime(100, audioCtx.currentTime + 0.1);
        }
        gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);
        osc.start(); osc.stop(audioCtx.currentTime + 0.1);
    }

    function switchPanel(type) {
        const panels = ['tasks-panel', 'news-panel', 'ballistics-panel', 'map-panel'];
        const btns = document.querySelectorAll('.nav-btn');
        panels.forEach(p => document.getElementById(p).style.display = 'none');
        btns.forEach(b => b.classList.remove('active'));

        if(type === 'tasks') { 
            document.getElementById('tasks-panel').style.display = 'block'; 
            btns[0].classList.add('active'); 
        } else if(type === 'news') {
            document.getElementById('news-panel').style.display = 'block';
            btns[1].classList.add('active');
            loadNews();
        } else if(type === 'ballistics') { 
            document.getElementById('ballistics-panel').style.display = 'block'; 
            btns[2].classList.add('active'); 
        } else { 
            document.getElementById('map-panel').style.display = 'block'; 
            btns[3].classList.add('active'); 
        }
    }

    // HABER SÄ°STEMÄ°
    let newsData = [];
    let newsCurrentIndex = 0;
    let newsProgress = 0;
    let newsPaused = false;
    let newsInterval;

    async function loadNews() {
        const container = document.getElementById('news-list-container');
        if(newsData.length > 0) return;
        
        container.innerHTML = "<div style='padding:20px; color:#444; font-size:12px;'>VERÄ° Ã‡EKÄ°LÄ°YOR...</div>";
        try {
            const response = await fetch('/api/news-json');
            newsData = await response.json();
            renderNewsList();
            startNewsAutoPlay();
        } catch (e) {
            container.innerHTML = "Ä°STÄ°HBARAT AKIÅžINDA HATA OLUÅžTU.";
        }
    }

    function renderNewsList() {
        const container = document.getElementById('news-list-container');
        container.innerHTML = "";
        newsData.forEach((item, i) => {
            const div = document.createElement('div');
            div.className = `news-item ${i === newsCurrentIndex ? 'active' : ''}`;
            div.innerHTML = `<h3>${item.title}</h3><span>${new Date(item.pub_timestamp*1000).toLocaleDateString('tr-TR')}</span>`;
            div.onclick = () => { newsCurrentIndex = i; newsProgress = 0; updateNewsDisplay(); showNewsDetail(i); };
            container.appendChild(div);
        });
        updateNewsDisplay();
    }

    function updateNewsDisplay() {
        if(!newsData[newsCurrentIndex]) return;
        document.getElementById('news-preview-img').src = newsData[newsCurrentIndex].pic_urls[0];
        document.querySelectorAll('.news-item').forEach((el, i) => el.classList.toggle('active', i === newsCurrentIndex));
    }

    function startNewsAutoPlay() {
        if(newsInterval) clearInterval(newsInterval);
        newsInterval = setInterval(() => {
            if(!newsPaused) {
                newsProgress += 1;
                document.getElementById('news-timer-bar').style.width = newsProgress + '%';
                if(newsProgress >= 100) {
                    newsProgress = 0;
                    newsCurrentIndex = (newsCurrentIndex + 1) % newsData.length;
                    updateNewsDisplay();
                }
            }
        }, 50); 
    }

function showNewsDetail(index) {
        const item = newsData[index];
        const box = document.getElementById('news-detail-box');
        
        // Ã–nce linkleri tespit edip <a> etiketine Ã§evirelim
        const urlRegex = /(https?:\/\/[^\s]+)/g;
        let contentWithLinks = item.content_tr.replace(urlRegex, (url) => {
            return `<a href="${url}" target="_blank" style="color:var(--primary); text-decoration:underline;">${url}</a>`;
        });

        document.getElementById('news-d-title').innerText = item.title;
        document.getElementById('news-d-date').innerText = new Date(item.pub_timestamp*1000).toLocaleString('tr-TR');
        
        // Sonra senin yaptÄ±ÄŸÄ±n gibi \n karakterlerini <br> yapalÄ±m
        document.getElementById('news-d-body').innerHTML = contentWithLinks.replace(/\n/g, '<br>');
        
        box.style.display = 'block';
        setTimeout(() => box.scrollIntoView({behavior:'smooth'}), 50);
    }

    const scrollBtn = document.getElementById("scrollTopBtn");
    window.onscroll = function() { if (document.body.scrollTop > 300 || document.documentElement.scrollTop > 300) scrollBtn.style.display = "block"; else scrollBtn.style.display = "none"; };
    function scrollToTop() { window.scrollTo({top: 0, behavior: 'smooth'}); }

    function filterTasks(event) {
        if (event && event.key === "Escape") { document.getElementById('taskSearch').value = ''; }
        const input = document.getElementById('taskSearch').value.toUpperCase();
        const hideDone = document.getElementById('hideDone').checked;
        const rows = document.querySelectorAll('.task-row');
        rows.forEach(row => {
            const text = row.innerText.toUpperCase();
            const isDone = row.querySelector('input').checked;
            const matchesSearch = text.indexOf(input) > -1;
            const shouldHide = hideDone && isDone;
            row.classList.toggle('hidden', !matchesSearch || shouldHide);
        });
    }

    // TABLOLARI DOLDURMA
    const ammoBody = document.getElementById('ammo-table-body');
    if(typeof ammoData !== 'undefined') {
        ammoData.forEach(group => {
            ammoBody.insertAdjacentHTML('beforeend', `<tr><td colspan="3" class="ammo-group">${group.category}</td></tr>`);
            group.items.forEach(item => {
                ammoBody.insertAdjacentHTML('beforeend', `<tr><td>${item.cal}</td><td>${item.type}</td><td><span class="t-badge ${item.t.toLowerCase()}">${item.t}</span></td></tr>`);
            });
        });
    }

    const mapListContainer = document.getElementById('map-list-container');
    if(typeof mapData !== 'undefined') {
        mapData.forEach(map => {
            mapListContainer.insertAdjacentHTML('beforeend', `<a href="${map.url}" target="_blank" class="map-link"><span class="name">${map.name}</span><span class="src">${map.source}</span></a>`);
        });
    }

    const listEl = document.getElementById('task-list');
    const fillEl = document.getElementById('fill');
    const statEl = document.getElementById('stat-val');
    const percentEl = document.getElementById('percent-val');
    let completedTasks = JSON.parse(localStorage.getItem('abi_tasks')) || [];

    function updateSuggestion() {
        if(typeof taskData === 'undefined') return;
        const activeObjectives = taskData.filter((_, i) => !completedTasks.includes(i)).slice(0, 3);
        const panel = document.getElementById('route-suggestion');
        if (activeObjectives.length > 0) {
            panel.style.display = 'flex';
            const mapMatch = activeObjectives[0].d.match(/Farm|Valley|Northridge|Armory|TV Station|Airport/i);
            document.getElementById('suggestion-content').innerHTML = `<strong>AKTÄ°F OPERASYON:</strong> ${mapMatch ? mapMatch[0] : "Belirsiz BÃ¶lge"} bÃ¶lgesine sÄ±zma yapmalÄ±sÄ±n.`;
            document.getElementById('next-task-list').innerHTML = `SÄ±radaki Hedefler: ${activeObjectives.map(t => t.n).join(" â†’ ")}`;
        } else { panel.style.display = 'none'; }
    }

    function refresh(e) {
        const rows = document.querySelectorAll('.task-row');
        if (e && e.target) { playFeedback(e.target.checked ? 'done' : 'undone'); }
        let checked = [];
        rows.forEach((row, index) => {
            const cb = row.querySelector('input');
            if(cb.checked) { row.classList.add('is-done'); checked.push(index); } 
            else { row.classList.remove('is-done'); }
        });
        completedTasks = checked;
        if(typeof taskData !== 'undefined') {
            const percentage = Math.round((checked.length / taskData.length) * 100);
            fillEl.style.width = percentage + '%';
            statEl.innerText = `${checked.length} / ${taskData.length}`;
            percentEl.innerText = `%${percentage} TAMAMLANDI`;
        }
        localStorage.setItem('abi_tasks', JSON.stringify(checked));
        updateSuggestion();
        filterTasks();
    }

    if(typeof taskData !== 'undefined') {
        taskData.forEach((t, i) => {
            const row = document.createElement('label');
            row.className = 'task-row';
            const isChecked = completedTasks.includes(i);
            if(isChecked) row.classList.add('is-done');
            row.innerHTML = `<input type="checkbox" ${isChecked ? 'checked' : ''}><div class="task-info"><span class="task-title">${i + 1}. ${t.n}</span><span class="task-desc">${t.d}</span></div>`;
            row.querySelector('input').addEventListener('change', refresh);
            listEl.appendChild(row);
        });
    }

    refresh();
    document.getElementById('current-date').innerText = new Date().toLocaleDateString('tr-TR');
</script>
<script defer src="/_vercel/insights/script.js"></script>
</body>
</html>